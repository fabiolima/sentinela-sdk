(function(n){typeof define=="function"&&define.amd?define(n):n()})(function(){"use strict";var m=Object.defineProperty;var f=(n,e,o)=>e in n?m(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o;var s=(n,e,o)=>(f(n,typeof e!="symbol"?e+"":e,o),o),g=(n,e,o)=>{if(!e.has(n))throw TypeError("Cannot "+o)};var c=(n,e,o)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,o)};var d=(n,e,o)=>(g(n,e,"access private method"),o);var i,l;function n(){return window.crypto.randomUUID()}function e(){const r=window.localStorage.getItem("sentinela-userid");if(!r){const t=n();return window.localStorage.setItem("sentinela-userid",t),t}return r}function o(){return console.log("https://sentinela-analytics.onrender.com"),"https://sentinela-analytics.onrender.com"}class u{constructor(){c(this,i);s(this,"endpoint");s(this,"domain");s(this,"userId")}start(){this.endpoint=o(),this.domain=document.currentScript.getAttribute("data-domain"),this.userId=e(),d(this,i,l).call(this)}async onError(t){console.log("Error caught",t);const a={message:t.error.message,stack:t.error.stack,filename:t.filename,lineno:t.lineno,colno:t.colno};try{await this.sendError(a)}catch(h){console.error(h)}}async sendError(t){t={...t,user_id:this.userId,date:new Date().toISOString(),href:location.href,referrer:document.referrer||null,domain:this.domain};const a=`${this.endpoint}/errors`;return fetch(a,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t})})}}i=new WeakSet,l=function(){window.addEventListener("error",t=>this.onError(t))},(()=>{console.log("Running sdk");const r=new u;window.Sentinela=r,window.Sentinela.start()})()});
